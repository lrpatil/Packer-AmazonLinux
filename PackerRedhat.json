{
	"variables": {
		"source_ami": "null",
		"aws_region": "null",
		"aws_access_key": "",
		"aws_secret_key": "",
		"iam_instance_profile": "",
		"aws_vpc_id": "",
		"aws_subnet_id": "",
		"security_group_id": "",
		"ssh_keypair_name": "",
		"ssh_private_key_file": "",
		"instance_size": "null",
		"ssh_username": "",
		"kms_key_id": "",
		"output_ami_name": "Golden-EC2-AMI-"
	},
	"builders": [{
		"type": "amazon-ebs",
		"source_ami": "{{user `source_ami`}}",
		"ami_virtualization_type": "hvm",
		"region": "{{user `aws_region`}}",
		"access_key": "{{user `aws_access_key`}}",
		"secret_key": "{{user `aws_secret_key`}}",
		"iam_instance_profile": "{{user `iam_instance_profile`}}",
		"vpc_id": "{{user `aws_vpc_id`}}",
		"subnet_id": "{{user `aws_subnet_id`}}",
		"security_group_id": "{{user `security_group_id`}}",
		"ssh_keypair_name": "{{user `ssh_keypair_name`}}",
		"ssh_private_key_file": "{{user `ssh_private_key_file`}}",
		"instance_type": "{{user `instance_size`}}",
		"ssh_username": "{{user `ssh_username`}}",
		"kms_key_id": "{{user `kms_key_id`}}",
		"shutdown_behavior": "stop",
		"communicator": "ssh",
		"ssh_pty": true,
		"encrypt_boot": "true",
		"force_deregister": "true",
		"force_delete_snapshot": "true",
		"ami_name": "{{user `output_ami_name`}}-{{timestamp}}",
		"tags": {
			"Name": "RHEL-Goldem-AMI",
			"BuiltBy": "Packer",
			"PackagesIncluded": "SSM|Python"
		}
	}],
	"description": "AWS image",
	"provisioners": [{
			"type": "shell",
			"inline": [
				"yum update -y"
			]
		},
		{
			"type": "shell",
			"execute_command": "echo 'packer' | sudo -S env {{ .Vars }} {{ .Path }}",
			"scripts": [
				"../Scripts/InstallPython.sh"
			]
		},
		{
			"type": "shell",
			"execute_command": "echo 'packer' | sudo -S env {{ .Vars }} {{ .Path }}",
			"scripts": [
				"../Scripts/InstallSSMAgent.sh"
			]
		}
	]
}